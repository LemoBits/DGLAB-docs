# 郊狼脉冲波形（概念、示例与转换）

## 概念解释

### 波形频率

郊狼将 1 秒分为 1000 ms，通过控制脉冲与间隔编码脉冲规律。波形频率表示一个输出单元的时长（输出单元由 X 个脉冲和 Y 个间隔组成），单位 ms。  
1Hz -> 1000ms；50Hz -> 20ms。

| 脉冲频率 | 波形频率 |
|:------:|:------:|
| 1Hz | 1000ms |
| 5Hz | 200ms |
| 10Hz | 100ms |
| 50Hz | 20ms |
| 100Hz | 10ms |
| 500Hz | 2ms |
| 1000Hz | 1ms |

V2 中波形频率由 [X 和 Y](/coyote-v2) 共同决定：X 表示连续 X 毫秒发出 X 个脉冲，Y 表示间隔 Y 毫秒再发出 X 个脉冲并循环。

> e.g  
> 【1,9】每隔9ms发1个脉冲，总耗时10ms，脉冲频率100hz，波形频率10ms。  
> 【5,95】每隔95ms发5个脉冲，总耗时100ms，体感约10hz，波形频率100ms。

V3 仅输入波形频率值，脉冲(X)与间隔(Y)的分配由 V3 协议中的频率平衡参数1决定。

### V3 频率输入压缩（10~1000ms → 10~240）

若希望波形频率线性变化，参考：

> e.g 1  
> 1. 目标脉冲频率：1~10Hz  
> 2. 转波形频率(ms)：1000,500,333,250,200,166,142,125,111,100  
> 3. 转实际输入值：240，180，146，130，120，113，108，105，102，100  
> 4. 4 个一组，不足补 0，每 100ms 向设备输入

> e.g 2  
> 1. 目标波形频率值：100~1000ms  
> 2. 转实际输入值：100，120，140，160，180，200，210，220，230，240  
> 3. 4 个一组，不足补 0，每 100ms 向设备输入

常见对照：

- 10ms → 10
- 20ms → 20
- 50ms → 50
- 100ms → 100
- 110ms → 102
- 150ms → 110
- 650ms → 204
- 680ms → 208
- 750ms → 215

### 波形频率与实际输入值的转化

人体对频率细微变化不敏感，频率越高，输入变化越细；该转化也用于压缩数据长度。

| 波形频率 | 输出值 | 脉冲频率 |
|:-----:|:---:|:------:|
| 10ms | 10 | 100Hz |
| 20ms | 20 | 50Hz |
| 50ms | 50 | 20Hz |
| 100ms | 100 | 10Hz |
| 110ms | 102 | 9Hz |
| 150ms | 110 | 6.6Hz |
| 650ms | 204 | 1.53Hz |
| 680ms | 208 | 1.47Hz |
| 750ms | 215 | 1.33Hz |

### 波形强度

一次脉冲由两个对称的正负单极性脉冲组成，高度由通道强度决定；通过脉冲宽度控制体感。脉冲越宽越强，越窄越弱。

- V2 中波形强度由 [Z](/coyote-v2) 决定，范围(0~20)，相对值。  
- V3 中波形强度范围(0~100)，相对值。  
- 映射关系：V2 波形强度 20 ≈ V3 波形强度 100。

### 输出窗口

- V2 输出窗口 100ms。  
- V3 输出窗口 25ms，但每次设置 4 组，等效 100ms。

建议：

1. 若希望稳定输出某个波形频率，建议稳定输入该波形频率值。
2. 若波形频率值大于输出窗口，下一周期输入的波形频率有所变化，实际输出可能与输入不同（设备内部会处理重排）。

### V2 → V3 转化

- V3 波形频率 = V2 (X + Y) 后，执行(10 ~ 1000) -> (10 ~ 240)的转化。  
- V3 波形强度 = V2 (Z * 5)。
